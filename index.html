<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>HD IN FOTO</title>
<style>
  html,body{margin:0;height:100%;overflow:hidden;background:#0a0a1a;color:#e2e8f0;font-family:'Poppins',sans-serif;}
  #particles{position:fixed;top:0;left:0;width:100%;height:100%;z-index:-1;background:radial-gradient(ellipse at bottom,#0f172a 0%,#020617 100%);}
  .content{position:relative;z-index:1;text-align:center;padding:40px;}
  h1{color:#38bdf8;margin-bottom:10px;}
  p{color:#94a3b8;margin-bottom:30px;}
  #dropZone{border:2px dashed #38bdf8;border-radius:16px;padding:40px;margin:20px auto;width:80%;max-width:500px;cursor:pointer;transition:.3s;}
  #dropZone:hover{background:#1e293b;}
  img{max-width:90%;border-radius:12px;margin-top:20px;box-shadow:0 0 25px rgba(56,189,248,.15);}
  button{margin:10px;background:#38bdf8;color:white;border:none;padding:10px 25px;border-radius:8px;font-size:1rem;cursor:pointer;transition:.3s;}
  button:hover{background:#0ea5e9;}
  .loader{border:4px solid #1e293b;border-top:4px solid #38bdf8;border-radius:50%;width:60px;height:60px;animation:spin 1.2s linear infinite;margin:25px auto 10px;display:none;}
  @keyframes spin{100%{transform:rotate(360deg);}}
  #status{color:#94a3b8;margin-top:8px;display:none;}
</style>
</head>
<body>
<canvas id="particles"></canvas>

<div class="content">
  <h1>HD IN FOTO V1 BY SAHRILMODZZ</h1>
  <p>TOOLS HD FOTO</p>

  <div id="dropZone">üìÅ Klik atau seret gambar ke sini</div>
  <img id="preview" style="display:none;">
  <div class="loader" id="loader"></div>
  <div id="status">Proses...</div>
  <img id="result" style="display:none;">
  <br>
  <button id="enhanceBtn" style="display:none;">‚ú® Jadikan HD</button>
  <button id="toggleBtn" style="display:none;">üì∏ Lihat Asli</button>
  <button id="downloadBtn" style="display:none;">Download</button>
  <canvas id="canvas" style="display:none;"></canvas>
</div>

<script>
// üå† Partikel Glow lembut
const c=document.getElementById("particles"),ctx=c.getContext("2d");
let parts=[];
function resize(){c.width=innerWidth;c.height=innerHeight;}
addEventListener("resize",resize);resize();
for(let i=0;i<120;i++){
  parts.push({x:Math.random()*c.width,y:Math.random()*c.height,vx:(Math.random()-.5)*.4,vy:(Math.random()-.5)*.4,s:Math.random()*2+0.5,a:Math.random()*100});
}
function animate(){
  ctx.clearRect(0,0,c.width,c.height);
  for(let p of parts){
    p.x+=p.vx;p.y+=p.vy;p.a+=.05;
    if(p.x<0||p.x>c.width)p.vx*=-1;
    if(p.y<0||p.y>c.height)p.vy*=-1;
    const glow=(Math.sin(p.a)*.5+.5)*0.8;
    ctx.beginPath();
    ctx.fillStyle=`rgba(56,189,248,${.15+glow*.3})`;
    ctx.shadowBlur=8+glow*10;
    ctx.shadowColor="#38bdf8";
    ctx.arc(p.x,p.y,p.s,0,6.28);
    ctx.fill();
  }
  requestAnimationFrame(animate);
}
animate();

// üß† Proses HD
const dz=document.getElementById("dropZone"),pv=document.getElementById("preview"),
rslt=document.getElementById("result"),cv=document.getElementById("canvas"),x=cv.getContext("2d"),
btn=document.getElementById("enhanceBtn"),ldr=document.getElementById("loader"),st=document.getElementById("status"),
tgl=document.getElementById("toggleBtn"),dl=document.getElementById("downloadBtn");
let hdImg,showingHD=false;

dz.onclick=()=>{const i=document.createElement("input");i.type="file";i.accept="image/*";i.onchange=e=>loadFile(e.target.files[0]);i.click();};
dz.addEventListener("dragover",e=>{e.preventDefault();dz.style.borderColor="#60a5fa";});
dz.addEventListener("dragleave",e=>{e.preventDefault();dz.style.borderColor="#38bdf8";});
dz.addEventListener("drop",e=>{e.preventDefault();loadFile(e.dataTransfer.files[0]);});

async function loadFile(file){
 if(!file)return;
 const url=URL.createObjectURL(file);
 const img=new Image();img.src=url;await img.decode();
 cv.width=img.width;cv.height=img.height;x.drawImage(img,0,0);
 pv.src=url;pv.style.display="block";dz.style.display="none";btn.style.display="inline-block";
}

btn.onclick=async()=>{
 btn.style.display="none";ldr.style.display="block";st.style.display="block";st.innerText="Proses...";
 await new Promise(r=>setTimeout(r,2600));

 const scale=2;
 const up=document.createElement("canvas");
 up.width=cv.width*scale;up.height=cv.height*scale;
 const ux=up.getContext("2d");
 ux.imageSmoothingEnabled=true;
 ux.imageSmoothingQuality="high";
 ux.drawImage(cv,0,0,up.width,up.height);

 let imgData=ux.getImageData(0,0,up.width,up.height);
 let data=imgData.data,w=up.width,h=up.height;
 const orig=new Uint8ClampedArray(data);

 // üîπ Penajaman multi-lapis + kejernihan
 const kernel=[0,-1,0,-1,5.5,-1,0,-1,0];
 for(let y=1;y<h-1;y++){
   for(let x=1;x<w-1;x++){
     for(let c=0;c<3;c++){
       let sum=0,idx=0;
       for(let ky=-1;ky<=1;ky++){
         for(let kx=-1;kx<=1;kx++){
           const px=((y+ky)*w+(x+kx))*4+c;
           sum+=orig[px]*kernel[idx++];
         }
       }
       const i=(y*w+x)*4+c;
       data[i]=Math.min(255,Math.max(0,sum*0.9 + orig[i]*0.1));
     }
   }
 }
 // üîπ Sedikit kontras & kejernihan natural
 for(let i=0;i<data.length;i+=4){
   data[i]=Math.pow(data[i]/255,0.9)*255;
   data[i+1]=Math.pow(data[i+1]/255,0.9)*255;
   data[i+2]=Math.pow(data[i+2]/255,0.9)*255;
 }

 ux.putImageData(imgData,0,0);
 hdImg=up.toDataURL("image/png");
 ldr.style.display="none";st.innerText="‚úÖ Selesai!";
 rslt.src=hdImg;rslt.style.display="block";pv.style.display="none";
 tgl.style.display="inline-block";dl.style.display="inline-block";showingHD=true;

 tgl.onclick=()=>{
  if(showingHD){rslt.style.display="none";pv.style.display="block";tgl.innerText="üíé Lihat HD";}
  else{pv.style.display="none";rslt.style.display="block";tgl.innerText="üì∏ Lihat Asli";}
  showingHD=!showingHD;
 };
 dl.onclick=()=>{const a=document.createElement("a");a.href=hdImg;a.download="HD-Jernih.png";a.click();};
};
</script>
</body>
